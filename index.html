<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kovaze Mushroom Hunt ‚Äì Smart Scanner</title>
<style>
body{font-family:system-ui,Segoe UI,Roboto,Arial;background:#0b1020;color:#e9eefc;margin:0}
h1{margin:0;font-size:28px;text-align:center;padding:20px 10px;color:#7df57d}
main{max-width:900px;margin:0 auto;padding:10px}
section{background:#121a34;border-radius:12px;padding:16px;margin-bottom:16px;border:1px solid rgba(255,255,255,.06)}
input,button{font-size:15px;border-radius:8px;padding:8px 10px;border:1px solid rgba(255,255,255,.1);background:#0e1732;color:#e9eefc}
button{cursor:pointer}
button:disabled{opacity:.5;cursor:not-allowed}
#log{background:#0a1228;min-height:220px;max-height:400px;overflow:auto;font-family:monospace;padding:10px;border-radius:8px}
.hit{padding:8px;border:1px solid rgba(125,245,125,.4);border-radius:8px;background:rgba(125,245,125,.07);margin:6px 0}
a{color:#8cd0ff}
.stats{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px;font-size:14px}
.stat{background:#0e1732;border:1px solid rgba(255,255,255,.05);padding:5px 9px;border-radius:6px}
</style>
</head>
<body>
<h1>üçÑ Kovaze Mushroom Hunt</h1>
<main>
<section>
<label>Start ID <input id="start" type="number" value="1" min="1"></label>
<label>End ID <input id="end" type="number" value="25000" min="1"></label>
<label>Concurrency <input id="conc" type="number" value="12" min="1" max="64"></label>
<label>Delay (ms) <input id="delay" type="number" value="150" min="0"></label>
<div style="margin-top:10px">
<button id="startBtn">Start Scan</button>
<button id="stopBtn" disabled>Stop</button>
<button id="clearBtn">Clear Log</button>
<button id="exportBtn" disabled>Export Hits</button>
</div>
<div class="stats">
<span class="stat">Checked: <b id="checked">0</b></span>
<span class="stat">Hits: <b id="hits">0</b></span>
<span class="stat">Progress: <b id="prog">0%</b></span>
<span class="stat">Elapsed: <b id="elapsed">00:00</b></span>
</div>
</section>
<section>
<h3>Found Mushrooms</h3>
<div id="found"></div>
</section>
<section>
<h3>Log</h3>
<div id="log"></div>
</section>
</main>
<script>
const ids=["39B70122","42F1D780","5C8837E9","F01F3FFC","2512485C","423E20D4","F42229EE","F0689D5F"];
const regex=new RegExp(ids.join("|"),"i");
const startEl=start,endEl=end,concEl=conc,delayEl=delay;
const logEl=log,foundEl=found,chk=checked,hitsEl=hits,progEl=prog,elapsedEl=elapsed;
let run=false,controllers=new Set(),checked=0,hits=0,startTime=0;
function log(msg){const t=new Date().toLocaleTimeString();logEl.innerHTML+=`[${t}] ${msg}<br>`;logEl.scrollTop=logEl.scrollHeight}
function addHit(id,title,line){const url=`https://kovaze.com/blog/${id}`;hits++;hitsEl.textContent=hits;
const div=document.createElement("div");div.className="hit";div.innerHTML=`<b>Found:</b> <a href="${url}" target="_blank">${url}</a><br><small>${line.replace(/</g,"&lt;")}</small>`;foundEl.prepend(div);log(`üçÑ Hit at /blog/${id}`)}
function fmt(s){const m=Math.floor(s/60).toString().padStart(2,"0"),ss=Math.floor(s%60).toString().padStart(2,"0");return`${m}:${ss}`}
async function fetchWithTimeout(url,ms,ctl){const id=setTimeout(()=>ctl.abort(),ms);try{return await fetch(url,{signal:ctl.signal})}finally{clearTimeout(id)}}
async function check(id){
 const ctl=new AbortController();controllers.add(ctl);
 try{
  const res=await fetchWithTimeout(`https://r.jina.ai/http://kovaze.com/blog/${id}`,12000,ctl);
  if(!res.ok){controllers.delete(ctl);return;}
  const html=await res.text();
  if(regex.test(html)){
    const line=(html.match(/<img[^>]+src="[^"]+\.gif"[^>]*>/i)||["match"])[0];
    addHit(id,"",line);
  }
 }catch{}finally{controllers.delete(ctl)}
}
async function startScan(){
 run=true;controllers.clear();
 document.getElementById("startBtn").disabled=true;
 document.getElementById("stopBtn").disabled=false;
 startTime=Date.now();checked=0;hits=0;hitsEl.textContent=0;
 const s=+startEl.value,e=+endEl.value,c=+concEl.value,d=+delayEl.value;
 const total=e-s+1;log(`Starting scan ${s}‚Üí${e} concurrency=${c}`);
 const ids=Array.from({length:total},(_,i)=>s+i);
 const worker=async()=>{while(run&&ids.length){const id=ids.shift();await check(id);checked++;chk.textContent=checked;
 const pct=Math.min(100,Math.round(checked/total*100));progEl.textContent=pct+"%";
 elapsedEl.textContent=fmt((Date.now()-startTime)/1000);
 if(d)await new Promise(r=>setTimeout(r,d));}}
 await Promise.all(Array.from({length:c},worker));
 log("Scan complete.");document.getElementById("startBtn").disabled=false;document.getElementById("stopBtn").disabled=true;run=false;
}
startBtn.onclick=startScan;
stopBtn.onclick=()=>{run=false;controllers.forEach(c=>c.abort());controllers.clear();log("Stopped.");document.getElementById("startBtn").disabled=false;stopBtn.disabled=true;}
clearBtn.onclick=()=>{logEl.innerHTML="";foundEl.innerHTML="";hits=checked=0;hitsEl.textContent=0;chk.textContent=0;progEl.textContent="0%";log("Cleared.");}
exportBtn.onclick=()=>{if(!hits)return;let csv="id,url\n";[...foundEl.querySelectorAll("a")].forEach(a=>{const id=a.href.split("/").pop();csv+=`${id},${a.href}\n`});
const blob=new Blob([csv],{type:"text/csv"});const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="mushroom_hits.csv";a.click();URL.revokeObjectURL(a.href);}
</script>
</body>
</html>